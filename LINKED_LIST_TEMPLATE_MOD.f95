!//////////////////////////////////////////////////////////////////////////////////////////////////!
!/                                                                                                /!
!/ TEMPLATE MOD for LINKED LISTS                                                                  /!
!/                                                                                                /!
!/ Instructions :                                                                                 /!
!/    - include this file into a .f95 module                                                      /!
!/    - define the following names:                                                               /!
!/        -> TEMPLATE                                                                             /!
!/        -> NODE_TEMPLATE                                                                        /!
!/        -> LINKED_LIST_TEMPLATE                                                                 /!
!/                                                                                                /!
!//////////////////////////////////////////////////////////////////////////////////////////////////!

!----- CONSTRUCTS ---------------------------------------------------------------------------------!
TYPE :: NODE_TEMPLATE
    TEMPLATE                     :: val_
    TYPE(NODE_TEMPLATE), POINTER :: pNext_
END TYPE
!::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::!
TYPE :: LINKED_LIST_TEMPLATE
    TYPE(NODE_TEMPLATE), POINTER :: pRoot_
    INTEGER                      :: size_
END TYPE
!----- CONSTRUCTS ---------------------------------------------------------------------------------!

CONTAINS
    !----- MODULE SUBROUTINES ---------------------------------------------------------------------!
    SUBROUTINE NEW_NODE(pNode, init_val, iReturn)
        IMPLICIT NONE
        !----- VARIABLES --------------------------------------------------------------------------!
        TYPE(NODE_TEMPLATE), POINTER, INTENT(INOUT) :: pNode
        TEMPLATE           ,          INTENT(IN   ) :: init_val 
        INTEGER            ,          INTENT(OUT  ) :: iReturn
        !----- INTERNALS --------------------------------------------------------------------------!
        INTEGER :: alloc_stat
        !----- VARIABLES --------------------------------------------------------------------------!
        
        iReturn = 0 ! And stays 0 if everything went alright...
        
        IF(ASSOCIATED(pNode)) THEN
            DEALLOCATE(pNode, STAT = alloc_stat)
            IF(alloc_stat /= 0) THEN
                iReturn = -1
                RETURN
            ENDIF
            pNode => NULL()
        ENDIF
        
        ALLOCATE(pNode, STAT = alloc_stat)
        
        IF(alloc_stat /= 0) THEN
            iReturn = 1
            RETURN
        ENDIF
        
        pNode%val_ = init_val
    END SUBROUTINE
    !..............................................................................................!
    SUBROUTINE NEW_LINKED_LIST()
        IMPLICIT NONE
        !----- VARIABLES --------------------------------------------------------------------------!
        
        !----- INTERNALS --------------------------------------------------------------------------!
        
        !----- VARIABLES --------------------------------------------------------------------------!
        
    END SUBROUTINE
    !..............................................................................................!
    SUBROUTINE DELETE_LINKED_LIST()
        IMPLICIT NONE
        !----- VARIABLES --------------------------------------------------------------------------!
        
        !----- INTERNALS --------------------------------------------------------------------------!
        
        !----- VARIABLES --------------------------------------------------------------------------!
        
    END SUBROUTINE
    !..............................................................................................!
    SUBROUTINE LL_APPEND()
        IMPLICIT NONE
        !----- VARIABLES --------------------------------------------------------------------------!
        
        !----- INTERNALS --------------------------------------------------------------------------!
        
        !----- VARIABLES --------------------------------------------------------------------------!
        
    END SUBROUTINE
    !..............................................................................................!
    SUBROUTINE LL_INSERT()
        IMPLICIT NONE
        !----- VARIABLES --------------------------------------------------------------------------!
        
        !----- INTERNALS --------------------------------------------------------------------------!
        
        !----- VARIABLES --------------------------------------------------------------------------!
        
    END SUBROUTINE
    !..............................................................................................!
    SUBROUTINE LL_DELETE()
        IMPLICIT NONE
        !----- VARIABLES --------------------------------------------------------------------------!
        
        !----- INTERNALS --------------------------------------------------------------------------!
        
        !----- VARIABLES --------------------------------------------------------------------------!
        
    END SUBROUTINE
    !..............................................................................................!
    SUBROUTINE LL_GET()
        IMPLICIT NONE
        !----- VARIABLES --------------------------------------------------------------------------!
        
        !----- INTERNALS --------------------------------------------------------------------------!
        
        !----- VARIABLES --------------------------------------------------------------------------!
        
    END SUBROUTINE
    !..............................................................................................!
    SUBROUTINE LL_PRINT_TO_CONSOLE()
        IMPLICIT NONE
        !----- VARIABLES --------------------------------------------------------------------------!
        
        !----- INTERNALS --------------------------------------------------------------------------!
        
        !----- VARIABLES --------------------------------------------------------------------------!
        
    END SUBROUTINE
    !..............................................................................................!
    SUBROUTINE LL_PRINT_TO_FILE()
        IMPLICIT NONE
        !----- VARIABLES --------------------------------------------------------------------------!
        
        !----- INTERNALS --------------------------------------------------------------------------!
        
        !----- VARIABLES --------------------------------------------------------------------------!
        
    END SUBROUTINE
    !----- MODULE SUBROUTINES ---------------------------------------------------------------------!